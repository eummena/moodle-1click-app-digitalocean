function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_message/message_drawer_router",["jquery","core/pubsub","core/str","core_message/message_drawer_events","core/aria"],function(a,b,c,d,e){var f={},g={},h={CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]",ROUTES_BACK:"[data-route-back]"},j=function(c,g){var j,k=[].slice.call(arguments).some(function(a){return"frompanel"==a}),l=[].slice.call(arguments,2),m=a.Deferred().resolve().promise();Object.keys(f[c]).forEach(function(a){var b=f[c][a],d=a===g;if(d){j=b}b.parameters.forEach(function(a){if("object"!==_typeof(a)||null===a){return}a.removeClass("previous");a.attr("data-from-panel",!1);if(d){if(k){a.attr("data-from-panel",!0)}a.removeClass("hidden");e.unhide(a.get())}else{if(!a.attr("data-in-panel")){a.addClass("hidden");e.hide(a.get())}else if("view-search"==g||"view-overview"==g){a.addClass("hidden");e.hide(a.get())}}})});if(j){if(j.onGo){m=j.onGo.apply(void 0,j.parameters.concat(l));for(var n=a(document.activeElement),o=!1,p=null,q=1,r;q<j.parameters.length;q++){r=j.parameters[q];if("object"!==_typeof(r)||null===r){continue}if(!p){p=r}if(r.has(n).length){o=!0;break}}if(!o){p.find(h.CAN_RECEIVE_FOCUS).filter(":visible").first().focus()}}}var s={route:g,params:l,renderPromise:m};b.publish(d.ROUTE_CHANGED,s);return s},k=function(b){var d=a(document.activeElement),e=j.apply(b,arguments),k=!1;if(!g[b]){g[b]=[]}g[b]=g[b].reduce(function(a,b){if(b.route===e.route){k=!0}if(!k){a.push(b)}return a},[]);var l=g[b].length,m=l?g[b][l-1]:null;if(m){for(var n=f[b][m.route],o=n.parameters,p=1;p<o.length;p++){if("object"!==_typeof(o[p])||null===o[p]){continue}o[p].addClass("previous")}m.focusElement=d;if(n.getDescription){n.getDescription.apply(null,n.parameters.concat(m.params)).then(function(a){return c.get_string("backto","core_message",a)}).then(function(a){return e.renderPromise.then(function(){f[b][e.route].parameters.forEach(function(b){if("object"!==_typeof(b)||!b){return}b.find(h.ROUTES_BACK).attr("aria-label",a)})})}).catch(function(){})}}g[b].push(e);return e};return{add:function add(a,b,c,d,e){if(!f[a]){f[a]=[]}f[a][b]={parameters:c,onGo:d,getDescription:e}},go:k,back:function back(a){if(g[a].length){g[a].pop();var b=g[a].pop();if(b){k.apply(void 0,[a,b.route].concat(b.params));window.setTimeout(function(){b.focusElement.focus()},50)}}}}});
//# sourceMappingURL=message_drawer_router.min.js.map
